﻿{% extends 'base.html' %}
{% load staticfiles %}

{% block videoclases-active %}class="menu-top-active"{% endblock %}

{% block extra-head %}
    <script type="text/javascript">
        function ResponseValues() {
            var self = this;
            self.alternativas = [
                {% for a in alternativas %}
                    {% if forloop.last %}
                        '{{ a }}'
                    {% else %}
                        '{{ a }}',
                    {% endif %}
                {% endfor %}
            ]
            self.value = ko.observable({{evaluacion.value}});
            self.videoclase = ko.observable({{group.videoclase.id}});
            self.evaluacion = ko.observable({{evaluacion.pk}});
            self.thumbUpGray = ko.observable('{% static "img/thumb-up-gray.png" %}');
            self.thumbUpGreen = ko.observable('{% static "img/thumb-up-green.png" %}');
            self.thumbDownGray = ko.observable('{% static "img/thumb-down-gray.png" %}');
            self.thumbDownRed = ko.observable('{% static "img/thumb-down-red.png" %}');
        }
    </script>
    <link href="{% static "css/src/my-style.css" %}" rel="stylesheet">
    <script src="{% static "js/src/evaluar.js" %}"></script>
    <script src="{% static "js/libs/jquery.validate.min.js" %}"></script>
    <script src="{% static "js/src/evaluarDocumentReady.js" %}"></script>
{% endblock %}

{% block body %}
    <div class="correct-answer" data-bind="visible: correctAnswer">
        <div align="center">
            <strong>¡Felicitaciones! Tu answer es correcta. En unos segundos cargará la siguiente VideoClase.</strong>
        </div>
    </div>
    <div class="wrong-answer" data-bind="visible: wrongAnswer">
        <div align="center">
            <strong>¡Oh no! La answer correcta era <span data-bind="text: correctAnswerText"></span>. En unos segundos cargará la siguiente VideoClase.</strong>
        </div>
    </div>
    <div class="content-wrapper">
        <div class="container">
            <div class="row">
                <div class="col-md-2 col-md-offset-10">
                    <button onclick="location.href = '{% url 'student' %}';" class="btn btn-info">Volver</button>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <h6 class="page-head-line">{{ user.student.course_actual.school.name }} - {{ user.student.course_actual.name }} - {{ group.homework.title }}</h6>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6">
                    <iframe width="100%" height="315" src="{{ group.videoclase.video }}" frameborder="0" allowfullscreen></iframe>
                    <form data-bind="event: {'submit': submitEvaluacionDeAlumno}">
                        <div class="col-md-6" align="right">
                            <input id="meGustaInput" width="35" height="46" type="image" data-bind="attr: { src: thumbUp }, click: evaluar(1)" />
                        </div>
                        <div class="col-md-6">
                            <input id="noMeGustaInput" width="35" height="46" type="image" data-bind="attr: { src: thumbDown }, click: evaluar(-1)" />
                        </div>
                    </form>
                </div>
                <div class="col-md-6">
                    <div class="panel panel-default">
                        <div class="panel-heading" style="line-height:1.3;">
                            Integrantes:<br/>
                            {% for a in group.students.all %}
                                {% if forloop.last %}
                                    {{ a.user.get_full_name }}
                                {% else %}
                                    {{ a.user.get_full_name }} -
                                {% endif %}
                            {% endfor %}
                        </div>

                        <div class="panel-body">
                            <div class="row">
                                <div class="col-md-12"><h4>{{ group.videoclase.question }}</h4></div>
                            </div>
                            <form id="answerForm" method="post">
                                {% csrf_token %}
                                <div class="row">
                                    <div class="col-md-12">
                                        <select name="answer" class="form-control" id="id_answer"
                                            data-bind="options: responseValues.alternativas,
                                            optionsCaption: '-- escoja una alternativa --',
                                            value: answer,
                                            valueAllowUnset: false"></select>
                                    </div>
                                </div>
                                <input type="hidden" name="videoclase" value="{{ group.videoclase.id }}" />
                                <button style="display:none" id="#answerButton" type="submit"></button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12" align="center">
                    <button data-bind="click: clickSiguienteVideoclase" class="btn btn-lg btn-success">Siguiente VideoClase</button>
                </div>
            </div>
        </div>
    </div>
{% endblock %}